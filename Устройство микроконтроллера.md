Микроконтроллер состоит из трёх основных частей:
1. **Процессорное ядро (CPU)** — выполняет вычисления
2. **Память** — хранит программу и данные
3. **Периферия** — взаимодействует с внешним миром

<!-- ИЛЛЮСТРАЦИЯ: Блок-схема микроконтроллера с тремя основными блоками и шиной между ними -->

Давайте разберём каждую часть подробнее.

### 3.1. Процессорное ядро (CPU)

**Процессорное ядро** (или просто **ядро**, CPU core) — это вычислительная часть микроконтроллера. Оно выполняет машинные инструкции: выбирает команду из памяти, декодирует её, выполняет операции над данными и управляет потоком выполнения.

Вы уже знаете, что такое процессор из курса информатики и работы с ПК. В микроконтроллере процессор работает точно так же, но:
- Обычно имеет меньшую частоту (десятки-сотни МГц вместо ГГц)
- Имеет меньше ядер (часто одно или два)
- Обычно не имеет сложных систем кэширования (или имеет упрощённый кэш)
- Может работать без операционной системы (bare metal) или с лёгкой RTOS

Набор доступных операций определяется **архитектурой ядра**. Например, ARM Cortex-M — популярная архитектура для микроконтроллеров. Именно она используется в RP2040.

> **Для новичков:** На первом этапе вам не нужно знать детали архитектуры процессора. Достаточно понимать, что ядро выполняет ваш код.

---

### 3.2. Память микроконтроллера

Память в микроконтроллере разделяется на два принципиально разных типа:

#### Flash-память (энергонезависимая)

**Flash-память** хранит программу (прошивку) и константы. Она сохраняет содержимое при отключении питания.

**Аналогия:** Flash — это как SSD в ноутбуке: хранит программу, не теряет данные при выключении, но встроена в устройство (в отличие от SD-карты, которую можно извлечь).

**Свойства:**
- ✅ Сохраняет данные без питания
- ✅ Большой объём (обычно от 32 КБ до нескольких МБ)
- ❌ Медленная запись
- ❌ Ограниченный ресурс циклов перезаписи (~10 000 - 1 000 000 циклов)

**Что хранится во Flash:**
- Код вашей программы
- Константы (`const` переменные)
- Строковые литералы ("Hello, world!")

**Важно:** Flash — это не аналог «диска», куда можно постоянно что-то дописывать. Это место для кода и редко меняющихся данных.

#### RAM (оперативная память)

**RAM** (Random Access Memory, ОЗУ) — это оперативная память для временных данных. Она теряет содержимое при отключении питания.

**Аналогия:** RAM — это как оперативная память в ПК. Она быстрая, но при выключении всё стирается.

**Свойства:**
- ✅ Очень быстрая запись и чтение
- ✅ Неограниченное количество циклов перезаписи
- ❌ Теряет данные без питания
- ❌ Меньший объём (обычно от 2 КБ до нескольких сотен КБ)

**Что хранится в RAM:**
- Переменные вашей программы
- Стек (локальные переменные функций)
- Буферы для обмена данными


```
Flash (энергонезависимая)          RAM (оперативная)
┌─────────────────────┐            ┌─────────────────────┐
│ Код программы       │            │ Переменные          │
│ (ваши функции)      │            │ int x = 10;         │
├─────────────────────┤            ├─────────────────────┤
│ Константы           │            │ Стек                │
│ const int a = 5;    │            │ (локальные          │
│ "Hello, world!"     │            │  переменные)        │
└─────────────────────┘            ├─────────────────────┤
                                   │ Буферы обмена       │
Сохраняется без питания            │ (UART, SPI...)      │
                                   └─────────────────────┘
                                   
                                   Теряется без питания
```


### 3.3. Периферия: первое знакомство

**Периферия** — это специализированные аппаратные блоки внутри микроконтроллера, которые выполняют типовые функции ввода-вывода и работы со временем.

Если CPU — универсальный исполнитель инструкций, то периферийные модули «заточены» под конкретные операции: измерять интервалы, генерировать сигналы, принимать и передавать данные, оцифровывать аналоговые величины.

<!-- ИЛЛЮСТРАЦИЯ: Схема "CPU + Периферия" - CPU в центре, вокруг него блоки GPIO, Timer, UART, SPI, I2C, ADC -->

Практически любая встраиваемая система строится вокруг связки «CPU + периферия»:
- **Ядро** реализует алгоритм
- **Периферийные блоки** обеспечивают взаимодействие с физическим миром

#### GPIO — цифровые входы и выходы

Наиболее понятный пример периферии — **GPIO** (General Purpose Input/Output, цифровые входы/выходы общего назначения).

**Вы уже знаете GPIO из работы с Raspberry Pi!** На RPi вы управляли светодиодами, читали кнопки через GPIO. В микроконтроллере GPIO работает точно так же.

**Что такое GPIO:**
- Это выводы (пины) микроконтроллера, которые можно настроить как вход или выход
- **Как выход:** можно включать/выключать (HIGH/LOW, 1/0)
- **Как вход:** можно читать состояние (нажата ли кнопка, есть ли сигнал)


```
Микроконтроллер                  Внешний мир
┌──────────────┐
│              │                    
│  GPIO 25     ├──► Выход ──────► LED ──┐
│  (выход)     │                        └─ GND
│              │                    
│  GPIO 15     │    Вход  ◄──────── Кнопка ──┐
│  (вход)      │                             └─ GND
└──────────────┘
```

**Пример кода (псевдокод):**
```c
// Настройка GPIO 25 как выход
gpio_init(25);
gpio_set_dir(25, OUTPUT);

// Включить светодиод
gpio_put(25, HIGH);  // или gpio_put(25, 1);

// Выключить светодиод
gpio_put(25, LOW);   // или gpio_put(25, 0);

// Настройка GPIO 15 как вход
gpio_init(15);
gpio_set_dir(15, INPUT);

// Прочитать состояние кнопки
if (gpio_get(15) == LOW) {
    // Кнопка нажата
}
```

> **Важно:** Даже на уровне GPIO есть инженерные нюансы: ограничения по току (для RP2040: 4-12 мА в зависимости от настройки, для других МК может быть до 20-25 мА), режимы подтяжек (pull-up/pull-down), скорость фронтов. Но для первого знакомства достаточно понимать GPIO как «цифровой вход/выход».

#### Другие виды периферии (кратко)

В микроконтроллере есть и другие периферийные модули. Мы подробно разберём их на следующих занятиях, а пока — краткое знакомство:

**Таймеры:**
- Измеряют интервалы времени
- Генерируют периодические события
- Пример: мигать светодиодом каждую секунду

**UART (последовательный интерфейс):**
- Передача данных между устройствами
- Пример: отладочный вывод (как `printf` в Си)

**SPI и I2C (интерфейсы связи):**
- Подключение датчиков и внешних устройств
- Пример: датчик температуры, дисплей

**АЦП (аналого-цифровой преобразователь):**
- Преобразует аналоговое напряжение в цифровой код
- Пример: чтение значения с потенциометра
- **Вы уже знаете АЦП из курса физики!**

> **Для новичков:** На первом занятии достаточно знать, что периферия существует и что она помогает микроконтроллеру взаимодействовать с внешним миром. Детали — на следующих занятиях.

> **Краткий вывод:** Периферия — это аппаратные модули для ввода-вывода. GPIO — самый простой пример: цифровые входы и выходы. Вы уже работали с GPIO на Raspberry Pi, в микроконтроллере всё похоже.
