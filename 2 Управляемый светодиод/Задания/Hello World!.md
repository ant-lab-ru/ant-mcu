---
тема: Мигающий светодиод
автор: Григорьев Василий
дата: 2026-02-04
---

# Результат

- [ ] На вашем компьютере установлен и настроен PUTTY
- [ ] Создан новый проект с названием ```02-printf```
- [ ] В проекте настроен ввод/вывод через COM-порт
- [ ] При запуске прошивки в терминале PUTTY выводится ```Hello World! ``` , имя устройства и версия прошивки раз в секунду
![[Pasted image 20260202173255.png]]
# Установка и настройка PUTTY
- Скачать бинарный файл консольной программы [PUTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html).
![[Pasted image 20260127115806.png]]
- Запустить скачанный файл. В результате должно отобразиться следующее окно:
![[Pasted image 20260202105738.png]]
- [[Определить имя COM-порта]].
- Теперь можно приступить к настройке COM-порта. В ```Connection type ``` выберите ```Serial```. В ```Serial line``` укажите название COM-порта. 
> [!ATTENTION] Внимание!
> В данном случае мы подключаемся не напрямую к UART, а к виртуальному COM-порту, который создает микроконтроллер RP2040 на PICO. USB данные не с фиксированной скоростью (baudrate), а пакетами по высокоскоростному USB-протоколу. **Поэтому в этом менять значение скорости не обязательно.**



![[Pasted image 20260204110523.png]]
# Создание нового проекта
- Создайте проект с названием ```02-printf``` аналогично [[Как начать работать с микроконтроллерами]]. 
> [!ATTENTION] Внимание!
> Вы можете скопировать папку проекта из предыдущего занятия и поменять ее название.
- В итоге у вас должна получиться следующая структура папок:
```
mcu
|-- 02-printf
	|-- main.c
	|-- CMakeLists.txt
	|-- linker_rp2040.ld
    |-- pico_sdk_import.cmake
```
- Теперь нужно поменять название проекта в ```CMakeLists.txt ``` с ```01-blink ``` на ```02-printf``` Для этого добавьте следующую строчку перед вызовом функции инициализации Pico SDK:
``` cmake
project(02_printf)
```
- Теперь явно указанное имя проекта можно везде заменить на ```${PROJECT_NAME} ```. Например добавление в проект файлов с исходным кодом теперь будет выглядеть так:
``` cmake
add_executable(${PROJECT_NAME}
    ${CMAKE_CURRENT_SOURCE_DIR}/main.c
)
```

# Настройка в Pico SDK способа ввода/вывода (stdio)
- По умолчанию поддерживается стандартный ввод/вывод через UART. Мы же хотим работать с микроконтроллером через виртуальный COM-порт (USB.) Для этого добавьте в```CMakeLists.txt ```  следующие строчки после указания файла, в котором находится линкер-скрипт: 
``` cmake
pico_enable_stdio_uart(${PROJECT_NAME} 0)
pico_enable_stdio_usb(${PROJECT_NAME} 1)
```

# Разработка и запуск прошивки
- Теперь мы настроили PUTTY и CMakeLists проекта. Осталось реализовать прошивку, которая выводит в PUTTY терминал ```Hello World! ``` , имя устройства и версию прошивки раз в секунду. В данном случае у нас только один файл с исходным кодом прошивки - это ```main.c```
> [!ATTENTION] Внимание!
> Если Вы создавали проект копированием файлов с прошлого занятия, то Вам нужно очистить ```main.c```
- Подключите библиотеку для работы с вводом/выводом данных (Standard Input/Output) ```stdio.h``` и библиотеку с базовыми функциями работы с микроконтроллером ```pico/stdlib.h```
- Определите имя устройство. Для этого добавьте **макрос препроцессора**, который создаёт текстовую константу (строку) с именем `DEVICE_NAME` и значением `"my-pico-device"`
``` c
#define DEVICE_NAME "my-pico-device"
```
- Аналогично добавьте версию устройства
``` c
#define DEVICE_VRSN "v0.0.1"
```
- В теле ``` main``` инициализируйте систему ввода/вывода ```stdio``` следующей строчкой:
``` c
stdio_init_all();
```
- В тело бесконечного цикла добавьте вывод ```Hello World!```, имени устройства и текущей версии. Для этого используется функция ```printf```. Например, вывод имени устройства будет выглядеть следующим образом:
``` c
printf("Device name: '%s'\n", DEVICE_NAME);
```
- Добавьте паузу на 1 с после вывода в COM-порт 
- Загрузите прошивку в устройство, убедитесь что в PUTTY-терминале выводится ```Hello World!```
