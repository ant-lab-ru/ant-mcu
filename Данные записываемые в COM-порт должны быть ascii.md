При записи в COM-порт в Python символы конвертируют в ASCII (точнее, в байты) по нескольким ключевым причинам:

## 1. **Сквозные байты**

COM-порт работает на уровне байтов, а не символов. Он передает последовательности байтов (0-255), а не текстовые строки в человекочитаемом формате.

## 2. **Совместимость с оборудованием**

Большинство устройств (Arduino, микроконтроллеры, модемы и др.) ожидают получить данные в виде байтов, а не строк Unicode.

## 3. **Примеры конвертации**


```python

# Правильный способ - отправка байтов
import serial

ser = serial.Serial('COM3', 9600)

# Метод 1: encode() - конвертация строки в байты
ser.write("Hello".encode('ascii'))
# или для простых ASCII символов
ser.write(b"Hello")  # b-строка уже содержит байты

# Метод 2: bytes() преобразование
ser.write(bytes("Hello", 'ascii'))

# Метод 3: bytearray()
ser.write(bytearray([72, 101, 108, 108, 111]))  # ASCII коды для "Hello"
```

## 4. **Важные нюансы**

- **Не только ASCII**: Хотя часто используют `encode('ascii')`, для других символов может потребоваться `encode('utf-8')` или другая кодировка
    
- **Бинарные данные**: Для отправки команд, управляющих символов (0x00-0x1F) или бинарных данных обязательно использование байтов
    

## 5. **Ошибка без конвертации**

python

# Это вызовет ошибку TypeError
ser.write("Hello")  # Ошибка! Нужны байты, а не строка

## 6. **Что происходит на принимающей стороне**

Устройство получает байты и интерпретирует их согласно своей логике:

- Как текст (если это ASCII)
    
- Как команды
    
- Как числовые значения