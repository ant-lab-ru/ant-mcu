---
занятие:
  - "[[Как начать работать с микроконтроллерами]]"
дата: 2026-01-25
---
### От исходного кода до прошивки

Вы пишете программу на языке Си (файлы `.c` и `.h`). Но микроконтроллер не понимает язык Си. Он понимает только **машинный код** — последовательность чисел (инструкций процессора).

**Компилятор** — это программа, которая переводит исходный код на Си в машинный код.

```
main.c (исходный код на Си)
    │
    │  Компилятор
    │  (arm-none-eabi-gcc)
    ↓
main.o (объектный файл)
    │
    │  Линкер
    │  (собирает всё вместе)
    ↓
firmware.elf (исполняемый файл)
    │
    │  objcopy
    │  (конвертация формата)
    ↓
firmware.uf2 (файл для прошивки)
    │
    │  Копирование на Pico
    ↓
Flash микроконтроллера
```

### Кросс-компиляция

Когда вы компилируете программу **на самом** Raspberry Pi **для него же**, компилятор создаёт код для процессора ARM в Raspberry Pi. Программа компилируется и запускается на одной и той же платформе.

Когда вы создаёте прошивку для микроконтроллера, ситуация другая:
- **Компиляция** происходит на вашем ПК (процессор x86 или ARM)
- **Выполнение** будет на микроконтроллере (процессор ARM Cortex-M)

Это называется **кросс-компиляция** (cross-compilation) — компиляция на одной платформе для выполнения на другой.

Поэтому нужен специальный **кросс-компилятор**. Для ARM микроконтроллеров обычно используется `arm-none-eabi-gcc`.
### Toolchain (инструментальная цепочка)

На практике под словом «компилятор» часто подразумевают всю **toolchain** — набор инструментов для сборки прошивки:

- **Компилятор** (`arm-none-eabi-gcc`) — переводит `.c` в `.o`
- **Ассемблер** (`arm-none-eabi-as`) — обрабатывает низкоуровневый код
- **Линкер** (`arm-none-eabi-ld`) — собирает всё в один файл
- **Утилиты** (`objcopy`, `objdump`, `size`) — работа с файлами

### Форматы файлов

После компиляции и линковки получается несколько файлов:

**ELF (Executable and Linkable Format):**
- Содержит машинный код, символы, отладочную информацию
- Используется отладчиком (GDB)
- Нельзя напрямую записать в микроконтроллер

**Прошивочные форматы:**
- **.bin** — сырой дамп памяти
- **.hex** — Intel HEX формат с адресами
- **.uf2** — USB Flashing Format (для Raspberry Pi Pico)

Для Raspberry Pi Pico используется формат **.uf2**. Это удобно: вы просто копируете файл на «флешку», и прошивка записывается автоматически.

> **Для новичков:** На первом этапе вам не нужно знать детали работы компилятора и линкера. SDK и система сборки делают всё автоматически. Достаточно понимать общую схему: исходный код → компилятор → прошивка.

> **Краткий вывод:** Компилятор переводит код на Си в машинный код. Для микроконтроллеров используется кросс-компиляция. Результат — файл прошивки (.uf2 для Pico), который записывается во Flash.

| **[[Встроенное программное обеспечение (прошивка)\|Предыдущий раздел]]** | [[Как начать работать с микроконтроллерами\|К занятию]] | **[[SDK — готовые программные компоненты\|Следующий раздел]]** |
| ------------------------------------------------------------------------ | ------------------------------------------------------- | -------------------------------------------------------------- |
